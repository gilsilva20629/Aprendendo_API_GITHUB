<!DOCTYPE html>

<html>
	<head>
		<!-- A -->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Shop</title>	
	</head>

	<body>
		<script>
			
			async function carregarProdutos(){
				
				try{
					
					const resposta  = await fetch("http://127.0.0.1:5000/products", {
						method: "GET",
						//header: {"Contente-Type": "text/html", "Access-Control-Allow-Origin": "no-cors" }
						header: {
							"Access-Control-Allow-Origin": "no-cors"
							//"Contente-Type": "application/json", // referente ao (body)
						}
					/*	body: JSON.stringify( 
							{  
								"chave": "valor",
								"chave": "valor",
								"chave": "valor",
								"chave": "valor",
								"chave": "valor"
								.
								..
								...
							}
						)
					*/
					
					});

					const dados = await resposta.json();
					window.produtos = dados["products"];
					console.log(window.produtos);

					for(let i = 0, slot = 0; i < 10; i++ , slot++ ){
						window.document.querySelector(`.slot_prod_0${slot}`).src = window.produtos[i]["images"][0];

						window.document.querySelector(`.slot_prod_0${slot}[name='title']`).innerHTML = window.produtos[i]['title'];
						window.document.querySelector(`.slot_prod_0${slot}[name='category']`).innerHTML = "Category: " + window.produtos[i]['category'];
						window.document.querySelector(`.slot_prod_0${slot}[name='price']`).innerHTML = "R$ " + window.produtos[i]['price'];
						window.document.querySelector(`.slot_prod_0${slot}[name='stock']`).textContent = "Disponível: " + window.produtos[i]['stock'];
						window.document.querySelector(`.slot_prod_0${slot}[name='barcode']`).innerHTML = window.produtos[i]['meta']['barcode'];
						window.document.querySelector(`.slot_prod_0${slot}[name='qrcode']`).innerHTML = window.produtos[i]['meta']['qrCode'];
						window.document.querySelector(`.slot_prod_0${slot}[name='rating']`).innerHTML = "Rating: " + window.produtos[i]['rating'];
					}

				}
				catch( error ){
					console.error("Error: ", error, "Msg: ", error.message);
				}
				finally{
					// A FINALLY instrução define um bloco de código a ser executado independentemente do resultado.

					// throw new Error("Esse e um erro que eu criei agora")
				}
			}

			carregarProdutos();

			
		</script>

		<script>

			console.log("Script2: ", window.produtos);

		/*
			fetch() é uma operação assíncrona. Quando você chama fetch(), o JavaScript não espera a requisição ser concluída antes de continuar executando o código subsequente. Isso significa que um segundo <script> pode rodar antes que a resposta do fetch() seja toda preenchido com os dados do servidor.		

			window.produtos = [];

			fetch('http://127.0.0.1:5000/products', {
				method: "GET",
				//header: {"Contente-Type": "text/html", "Access-Control-Allow-Origin": "no-cors" },
				header: {
				//"Contente-Type": "application/json", // referente ao (body)
				"Access-Control-Allow-Origin": "no-cors"
				 }

			})
			.then(res => res.json())
			//.then(data => console.log(data["products"][0]));
			.then(data => {
				//console.log("Teste Server: ", data["products"][0]["images"][0]));
				window.produtos = data["products"];
				console.log(window.produtos[0]['images'][0]);
				//console.log(window.produtos);
				
			})
			.catch( error => {
				console.error('Error: ', error);
			});
		*/

		</script>


		<div class="slot_prod" style="width: 20%; height:300; border:1px solid black; margin: 22px; padding: 10px; display: inline-block;">
			<img class="slot_prod_00" width="100%" height="200px">
			<p>
				<small class="slot_prod_00" name="title"> </small><br>
				<small class="slot_prod_00" name="category"> </small><br>
				<small class="slot_prod_00" name="price"> </small><br>
				<small class="slot_prod_00" name="stock"> </small><br>
				<small class="slot_prod_00" name="barcode">	</small><br>
				<small class="slot_prod_00" name="qrcode"> </small><br>
				<small class="slot_prod_00" name="rating"> </small><br>
			</p>
		</div>
		
		<div class="slot_prod" style="width: 20%; height:300; border:1px solid black; margin: 22px; padding: 10px; display: inline-block;">
			<img class="slot_prod_01" width="100%" height="200px">
			<p>
				<small class="slot_prod_01" name="title"> </small><br>
				<small class="slot_prod_01" name="category"> </small><br>
				<small class="slot_prod_01" name="price"> </small><br>
				<small class="slot_prod_01" name="stock"> </small><br>
				<small class="slot_prod_01" name="barcode">	</small><br>
				<small class="slot_prod_01" name="qrcode"> </small><br>
				<small class="slot_prod_01" name="rating"> </small><br>
			</p>
		</div>

		<div class="slot_prod" style="width: 20%; height:300; border:1px solid black; margin: 22px; padding: 10px; display: inline-block;">
			<img class="slot_prod_02" width="100%" height="200px">
			<p>
				<small class="slot_prod_02" name="title"> </small><br>
				<small class="slot_prod_02" name="category"> </small><br>
				<small class="slot_prod_02" name="price"> </small><br>
				<small class="slot_prod_02" name="stock"> </small><br>
				<small class="slot_prod_02" name="barcode">	</small><br>
				<small class="slot_prod_02" name="qrcode"> </small><br>
				<small class="slot_prod_02" name="rating"> </small><br>
			</p>
		</div>

		<div class="slot_prod" style="width: 20%; height:300; border:1px solid black; margin: 22px; padding: 10px; display: inline-block;">
			<img class="slot_prod_03" width="100%" height="200px">
			<p>
				<small class="slot_prod_03" name="title"> </small><br>
				<small class="slot_prod_03" name="category"> </small><br>
				<small class="slot_prod_03" name="price"> </small><br>
				<small class="slot_prod_03" name="stock"> </small><br>
				<small class="slot_prod_03" name="barcode">	</small><br>
				<small class="slot_prod_03" name="qrcode"> </small><br>
				<small class="slot_prod_03" name="rating"> </small><br>
			</p>
		</div>

		<div class="slot_prod" style="width: 20%; height:300; border:1px solid black; margin: 22px; padding: 10px; display: inline-block;">
			<img class="slot_prod_04" width="100%" height="200px">
			<p>
				<small class="slot_prod_04" name="title"> </small><br>
				<small class="slot_prod_04" name="category"> </small><br>
				<small class="slot_prod_04" name="price"> </small><br>
				<small class="slot_prod_04" name="stock"> </small><br>
				<small class="slot_prod_04" name="barcode">	</small><br>
				<small class="slot_prod_04" name="qrcode"> </small><br>
				<small class="slot_prod_04" name="rating"> </small><br>
			</p>
		</div>

		<div class="slot_prod" style="width: 20%; height:300; border:1px solid black; margin: 22px; padding: 10px; display: inline-block;">
			<img class="slot_prod_05" width="100%" height="200px">
			<p>
				<small class="slot_prod_05" name="title"> </small><br>
				<small class="slot_prod_05" name="category"> </small><br>
				<small class="slot_prod_05" name="price"> </small><br>
				<small class="slot_prod_05" name="stock"> </small><br>
				<small class="slot_prod_05" name="barcode">	</small><br>
				<small class="slot_prod_05" name="qrcode"> </small><br>
				<small class="slot_prod_05" name="rating"> </small><br>
			</p>
		</div>

		<div class="slot_prod" style="width: 20%; height:300; border:1px solid black; margin: 22px; padding: 10px; display: inline-block;">
			<img class="slot_prod_06" width="100%" height="200px">
			<p>
				<small class="slot_prod_06" name="title"> </small><br>
				<small class="slot_prod_06" name="category"> </small><br>
				<small class="slot_prod_06" name="price"> </small><br>
				<small class="slot_prod_06" name="stock"> </small><br>
				<small class="slot_prod_06" name="barcode">	</small><br>
				<small class="slot_prod_06" name="qrcode"> </small><br>
				<small class="slot_prod_06" name="rating"> </small><br>
			</p>
		</div>

		<div class="slot_prod" style="width: 20%; height:300; border:1px solid black; margin: 22px; padding: 10px; display: inline-block;">
			<img class="slot_prod_07" width="100%" height="200px">
			<p>
				<small class="slot_prod_07" name="title"> </small><br>
				<small class="slot_prod_07" name="category"> </small><br>
				<small class="slot_prod_07" name="price"> </small><br>
				<small class="slot_prod_07" name="stock"> </small><br>
				<small class="slot_prod_07" name="barcode">	</small><br>
				<small class="slot_prod_07" name="qrcode"> </small><br>
				<small class="slot_prod_07" name="rating"> </small><br>
			</p>
		</div>

		<div class="slot_prod" style="width: 20%; height:300; border:1px solid black; margin: 22px; padding: 10px; display: inline-block;">
			<img class="slot_prod_08" width="100%" height="200px">
			<p>
				<small class="slot_prod_08" name="title"> </small><br>
				<small class="slot_prod_08" name="category"> </small><br>
				<small class="slot_prod_08" name="price"> </small><br>
				<small class="slot_prod_08" name="stock"> </small><br>
				<small class="slot_prod_08" name="barcode">	</small><br>
				<small class="slot_prod_08" name="qrcode"> </small><br>
				<small class="slot_prod_08" name="rating"> </small><br>
			</p>
		</div>

		<div class="slot_prod" style="width: 20%; height:300; border:1px solid black; margin: 22px; padding: 10px; display: inline-block;">
			<img class="slot_prod_09" width="100%" height="200px">
			<p>
				<small class="slot_prod_09" name="title"> </small><br>
				<small class="slot_prod_09" name="category"> </small><br>
				<small class="slot_prod_09" name="price"> </small><br>
				<small class="slot_prod_09" name="stock"> </small><br>
				<small class="slot_prod_09" name="barcode">	</small><br>
				<small class="slot_prod_09" name="qrcode"> </small><br>
				<small class="slot_prod_09" name="rating"> </small><br>
			</p>
		</div>
		<!--
		<script>	
			fetch('https://dummyjson.com/products?limit=0') // todos os itens
			.then(response => {

				res = response.json();
				console.log(res);
				console.log("___________________");

				//return response.json();
				//return response.text();
				return res;
			})
			.then(data => console.log(data["products"][0]["images"]));
		</script>
		-->
		

		<!--
		<script>	
			fetch('https://dummyjson.com/products/1')
			.then(response => {

				res = response.json();
				console.log(res);
				console.log("___________________");

				//return response.json();
				//return response.text();
				return res;
			})
			.then(data => console.log(data["images"][0]));
		</script>
		-->

	</body>
</html>

